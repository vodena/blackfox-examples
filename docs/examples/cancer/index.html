<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.15.2 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Cancer Example - BlackFox examples</title>
<meta name="description" content="">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="BlackFox examples">
<meta property="og:title" content="Cancer Example">
<meta property="og:url" content="/examples/cancer/">


  <meta property="og:description" content="">







  <meta property="article:published_time" content="2019-03-27T15:28:47+01:00">






<link rel="canonical" href="/examples/cancer/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "Vodéna",
      "url": null,
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="BlackFox examples Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--example wide">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/apple-touch-icon.png" alt=""></a>
        
        <a class="site-title" href="/">BlackFox Examples</a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/posts/" >Posts</a>
            </li><li class="masthead__menu-item">
              <a href="/examples/" >Examples</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  

  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    
    <!-- <meta itemprop="headline" content="Cancer Example"> -->
    
    
    <!-- <meta itemprop="description" content=""> -->
    
    
    

    <div class="page__inner-wrap">
      
      <!-- <header>
        <h1 id="page-title" class="page__title" itemprop="headline">
          Cancer Example
</h1>
        
      </header> -->
      

      <section class="page__content" itemprop="text">
        

        


        <div>

          
<h1 id="cancer">Cancer</h1>

<h3 id="problem-explanation">Problem explanation:</h3>

<p>Like other cancers, breast cancer is an uncontrolled growth of breast cells. Breast cancer occurs as a result of abnormal changes or mutation in the genes responsible for regulating the healthy growth of breast. The genes are in each cell’s nucleus, which acts as the “controller” of concern cell.</p>

<p>This abnormal tumour-like growth can be benign (not cancerous) or malignant (cancerous property). Benign tumours are close to normal in appearance, they grow comparatively slowly, and they do not invade or spread to nearby tissue and other parts of the body. As malignant cells have the potential to grow as cancer If they are left unchecked or untreated, they eventually can spread to nearby tissue and beyond an original tumour to other parts of the body.
 We need to classify a tumor as either benign or malignant based on cell descriptions gathered by microscopic examination. 
The data was originally obtained from the University of Wisconsin Hospitals, Madison, from Dr. William H. Wolberg. Data set has 699 observations, all inputs are continuous, 65.5% of the examples are benign. The dataset itself is located here, in the field cancer.</p>

<p>This is classification problem and the results are two outputs, benign or malign. Model inputs are:</p>

<ul>
  <li>Clump thickness,</li>
  <li>Uniformity of cell size,</li>
  <li>Uniformiti of cell shape,</li>
  <li>Marginal adhesion,</li>
  <li>Single epithelial cell size,</li>
  <li>Bare nuclei,</li>
  <li>Bland chromatin,</li>
  <li>Normal nucleoli,</li>
  <li>Mitoses.</li>
</ul>

<h3 id="problem-solution">Problem solution:</h3>
<p>Data set contains only 699 observations, so it is relatively small data set. We have divided the data set in two sets, training set, which contains 599 observations and test set, which contains 100 observations. We solved problem in two ways, with Python and Black Fox. We measured the model performance with K-cross validation (K=5) and for feature scaling we used min-max scaler. To stop training at the right time we used Early Stopping.</p>

<h4 id="update-keras-to-latest-version">Update Keras to latest version:</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">keras</span><span class="o">==</span><span class="mf">2.2.4</span>
</code></pre></div></div>

<h1 id="data-preprocessing">Data preprocessing</h1>
<h4 id="importing-dataset">Importing dataset:</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Importing the libraries
</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>

<span class="c1"># Importing the date as data frame wich we will import with pandas using the read_csv function.
</span><span class="n">dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'CancerData.csv'</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="dataset-info">Dataset info:</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dataframe</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>

<h4 id="dataset-description">Dataset description:</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dataframe</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</code></pre></div></div>

<h4 id="dataset-histogram-">Dataset histogram :</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dataframe</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">));</span>
</code></pre></div></div>

<h4 id="corelation-heatmap">Corelation heatmap:</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">dataframe</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
</code></pre></div></div>

<h4 id="we-will-separate-data-frame-into-matrix-x-of-features-and-dependent-variable-which-is-matrix-y">We will separate data frame into matrix X of features and dependent variable which is matrix y.</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">9</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">9</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</code></pre></div></div>

<h4 id="we-dont-need-to-scale-our-data-because-they-are-already-scaled-so-we-can-split-the-dataset-into-the-training-set-and-test-set">We dont need to scale our data because they are already scaled, so we can split the dataset into the training set and test set.</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<h1 id="option-1---manually-finding-best-ann">Option 1 - manually finding best ANN:</h1>
<h4 id="after-many-times-of-guessing-the-parameters-for-model-this-are-the-best-one-that-we-have-found-you-dont-see-our-such-enormous-effort-and-huge-time-to-find-this-parameters">After many times of guessing the parameters for model this are the best one that we have found (you dont see our such enormous effort and huge time to find this parameters).</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">keras</span>
<span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span><span class="n">Dropout</span>
<span class="kn">from</span> <span class="nn">keras.callbacks</span> <span class="kn">import</span> <span class="n">Callback</span><span class="p">,</span> <span class="n">TensorBoard</span><span class="p">,</span> <span class="n">ModelCheckpoint</span>
<span class="kn">from</span> <span class="nn">keras.callbacks</span> <span class="kn">import</span> <span class="n">EarlyStopping</span>

<span class="kn">import</span> <span class="nn">time</span>
<span class="n">start1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="n">classifier</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span> <span class="n">kernel_initializer</span> <span class="o">=</span> <span class="s">'uniform'</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s">'sigmoid'</span><span class="p">,</span> <span class="n">input_dim</span> <span class="o">=</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span> <span class="n">kernel_initializer</span> <span class="o">=</span> <span class="s">'uniform'</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s">'sigmoid'</span><span class="p">))</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span> <span class="n">kernel_initializer</span> <span class="o">=</span> <span class="s">'uniform'</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s">'sigmoid'</span><span class="p">))</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">kernel_initializer</span> <span class="o">=</span> <span class="s">'uniform'</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s">'sigmoid'</span><span class="p">))</span>
<span class="n">es</span> <span class="o">=</span> <span class="n">EarlyStopping</span><span class="p">(</span><span class="n">monitor</span> <span class="o">=</span> <span class="s">'val_loss'</span><span class="p">,</span>
                   <span class="n">mode</span> <span class="o">=</span> <span class="s">'auto'</span><span class="p">,</span>
                   <span class="c1">#min_delta = 1e-2,
</span>                   <span class="n">patience</span> <span class="o">=</span> <span class="mi">150</span><span class="p">,</span>
                   <span class="n">verbose</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                   <span class="c1">#baseline=0.4,
</span>                   <span class="n">restore_best_weights</span> <span class="o">=</span> <span class="bp">True</span>
                  <span class="p">)</span>
<span class="n">classifier</span><span class="o">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">optimizer</span> <span class="o">=</span> <span class="s">'rmsprop'</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="s">'mean_absolute_error'</span><span class="p">,</span> <span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="s">'accuracy'</span><span class="p">])</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">validation_split</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span> <span class="n">epochs</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">,</span> <span class="n">callbacks</span> <span class="o">=</span> <span class="p">[</span><span class="n">es</span><span class="p">],</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">end1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="n">time1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">end1</span><span class="o">-</span><span class="n">start1</span><span class="p">)</span>
<span class="n">minutes1</span><span class="p">,</span> <span class="n">seconds1</span><span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">time1</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
<span class="n">hours1</span><span class="p">,</span> <span class="n">minutes1</span><span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">minutes1</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="we-just-trained-our-artificial-neural-network-on-the-training-set-and-now-its-time-to-make-the-prediction-on-the-test-set">We just trained our artificial neural network on the training set and now it’s time to make the prediction on the test set.</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y_pred_trained</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="c1">#print("Predicted values are:\n\n", y_pred_trained[:10,:])
</span>
<span class="n">y_winner</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_pred_trained</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">y_pred_trained</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">y_winner</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y_winner</span> <span class="o">==</span> <span class="bp">True</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">y_winner_test</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_test</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">y_test</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">y_winner_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y_winner_test</span> <span class="o">==</span> <span class="bp">True</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_winner</span><span class="p">,</span> <span class="n">y_winner_test</span><span class="p">)</span>

<span class="n">errorOnTestSetTrained</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="n">cm</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">cm</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Time to manually train one network is "</span><span class="p">,</span> <span class="n">time1</span><span class="p">,</span><span class="s">"seconds("</span><span class="p">,</span><span class="n">hours1</span><span class="p">,</span><span class="s">"hours,"</span><span class="p">,</span><span class="n">minutes1</span><span class="p">,</span><span class="s">"minutes and "</span><span class="p">,</span><span class="n">seconds1</span><span class="p">,</span><span class="s">"seconds )."</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">We got confusion matrix:</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">cm</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Test set error on manually train one network, which we can read in confusion matrix is"</span><span class="p">,</span><span class="n">errorOnTestSetTrained</span><span class="p">,</span><span class="s">"</span><span class="si">%</span><span class="s">."</span><span class="p">)</span>
</code></pre></div></div>

<h1 id="option-2---parameter-tuning">Option 2 - Parameter tuning</h1>
<h4 id="we-have-two-type-of-parameters--the-parameters-that-are-leaned-from-the-model-during-the-training-and-these-are-the-weights-and-we-have-some-other-parameters-that-stay-fixed-and-this-parameters-are-called-the-hyperparameters-so-for-example-this-hyperparameters-are-the-number-of-epoch-the-bach-size-the-optimizer-or-the-number-of-neurons-in-the-layers-when-we-trained-our-ann-we-trained-it-with-some-fixed-values-of-this-hyperparameters-but-meybe-that-by-taking-some-other-values-we-would-get-to-better-accuracy-over-all-with-k-cross-validation-and-so-thats-what-parameter-tuning-is-all-about-it-consists-of-finding-the-best-values-of-this-hyperparameters-and-we-are-gonna-do-this-with-the-technique-called-grid-search-that-will-test-several-combinations-of-this-values-and-it-will-return-the-best-choise-that-leads-to-the-best-accuracy-with-k-cross-validation">We have two type of parameters,  the parameters that are leaned from the model during the training and these are the weights, and we have some other parameters that stay fixed, and this parameters are called the hyperparameters. So for example this hyperparameters are the number of epoch, the bach size, the optimizer or the number of neurons in the layers. When we trained our ANN, we trained it with some fixed values of this hyperparameters, but meybe that by taking some other values we would get to better accuracy over all with K cross validation, and so that’s what parameter tuning is all about, it consists of finding the best values of this hyperparameters and we are gonna do this with the technique called grid search that will test several combinations of this values and it will return the best choise that leads to the best accuracy with K cross validation.</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">keras.wrappers.scikit_learn</span> <span class="kn">import</span> <span class="n">KerasClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span>

<span class="kn">import</span> <span class="nn">time</span>
<span class="n">start2</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">build_classifier</span><span class="p">(</span><span class="n">optimizer</span><span class="p">):</span>
    <span class="n">classifier</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
    <span class="n">classifier</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span> <span class="n">kernel_initializer</span> <span class="o">=</span> <span class="s">'uniform'</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s">'sigmoid'</span><span class="p">,</span> <span class="n">input_dim</span> <span class="o">=</span> <span class="mi">9</span><span class="p">))</span>
    <span class="n">classifier</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span> <span class="n">kernel_initializer</span> <span class="o">=</span> <span class="s">'uniform'</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s">'sigmoid'</span><span class="p">))</span>
    <span class="n">classifier</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span> <span class="n">kernel_initializer</span> <span class="o">=</span> <span class="s">'uniform'</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s">'sigmoid'</span><span class="p">))</span>
    <span class="n">classifier</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">kernel_initializer</span> <span class="o">=</span> <span class="s">'uniform'</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s">'sigmoid'</span><span class="p">))</span>
    <span class="n">classifier</span><span class="o">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="s">'mean_absolute_error'</span><span class="p">,</span> <span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="s">'accuracy'</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">classifier</span>

<span class="n">Tuning_classifier</span> <span class="o">=</span> <span class="n">KerasClassifier</span><span class="p">(</span><span class="n">build_fn</span> <span class="o">=</span> <span class="n">build_classifier</span><span class="p">)</span>
<span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s">'batch_size'</span> <span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">32</span><span class="p">],</span>
              <span class="s">'epochs'</span> <span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">3000</span><span class="p">],</span>
              <span class="s">'optimizer'</span> <span class="p">:</span> <span class="p">[</span><span class="s">'adam'</span><span class="p">,</span><span class="s">'rmsprop'</span><span class="p">]}</span>

<span class="n">grid_search</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">Tuning_classifier</span><span class="p">,</span>
                           <span class="n">param_grid</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span>
                           <span class="c1">#scoring='accurasy',
</span>                           <span class="n">cv</span><span class="o">=</span><span class="mi">10</span>
                          <span class="p">)</span>

<span class="n">grid_search</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">best_parameters</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_params_</span>
<span class="n">best_accuracy</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_score_</span>

<span class="k">print</span><span class="p">(</span><span class="s">"Best parameters are :</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">best_parameters</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Best accuracy is :</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">best_accuracy</span><span class="p">)</span>


<span class="n">end2</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="n">time2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">end2</span><span class="o">-</span><span class="n">start2</span><span class="p">)</span>
<span class="n">minutes2</span><span class="p">,</span> <span class="n">seconds2</span><span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">time2</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
<span class="n">hours2</span><span class="p">,</span> <span class="n">minutes2</span><span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">minutes2</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Time training one network is "</span><span class="p">,</span> <span class="n">time2</span><span class="p">,</span><span class="s">"seconds("</span><span class="p">,</span><span class="n">hours2</span><span class="p">,</span><span class="s">"hours,"</span><span class="p">,</span><span class="n">minutes2</span><span class="p">,</span><span class="s">"minutes and "</span><span class="p">,</span><span class="n">seconds2</span><span class="p">,</span><span class="s">"seconds)."</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="we-got-our-artificial-neural-network-which-is-in-model-named-grid_search-now-its-time-to-make-the-prediction-on-the-test-set">We got our artificial neural network which is in model named “grid_search”. Now it’s time to make the prediction on the test set.</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y_pred_tuning</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="c1">#print("Predicted values are:\n\n", y_pred_tuning[:10,:])
</span>
<span class="n">y_pred_rounded_tuning</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_pred_tuning</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">y_pred_tuning</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">y_pred_rounded_tuning</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y_pred_rounded_tuning</span> <span class="o">==</span> <span class="bp">True</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">y_winner_test_tuning</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_test</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">y_test</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">y_winner_test_tuning</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y_winner_test_tuning</span> <span class="o">==</span> <span class="bp">True</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_winner_test_tuning</span><span class="p">,</span> <span class="n">y_pred_rounded_tuning</span><span class="p">)</span>

<span class="n">errorOnTestSetTuning</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="n">cm</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">cm</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Time needed for tuning is "</span><span class="p">,</span> <span class="n">time2</span><span class="p">,</span><span class="s">"seconds("</span><span class="p">,</span><span class="n">hours2</span><span class="p">,</span><span class="s">"hours,"</span><span class="p">,</span><span class="n">minutes2</span><span class="p">,</span><span class="s">"minutes and "</span><span class="p">,</span><span class="n">seconds2</span><span class="p">,</span><span class="s">"seconds)."</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">We got confusion matrix:</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">cm</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Test set error with tuning, which we can read in confusion matrix is"</span><span class="p">,</span><span class="n">errorOnTestSetTuning</span><span class="p">,</span><span class="s">"</span><span class="si">%</span><span class="s">."</span><span class="p">)</span>
</code></pre></div></div>

<h1 id="option-3---black-fox-service-finding-best-ann">Option 3 - Black fox service finding best ANN:</h1>

<h4 id="install-black-fox-service">Install Black fox service:</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">blackfox</span><span class="o">-</span><span class="mf">1.0.0</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
</code></pre></div></div>

<h4 id="lets-run-black-fox-service-to-find-best-ann">Let’s run Black Fox service to find best ANN:</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Importing the BF service libraries
</span><span class="kn">from</span> <span class="nn">blackfox</span> <span class="kn">import</span> <span class="n">BlackFox</span>
<span class="kn">from</span> <span class="nn">blackfox</span> <span class="kn">import</span> <span class="n">KerasOptimizationConfig</span>
<span class="kn">from</span> <span class="nn">blackfox</span> <span class="kn">import</span> <span class="n">OptimizationEngineConfig</span>
<span class="kn">import</span> <span class="nn">h5py</span>
<span class="c1">#from keras.models import load_model
#import numpy as np
#import pandas as pd
</span>
<span class="n">blackfox_url</span> <span class="o">=</span> <span class="s">'http://147.91.204.14:32701'</span>
<span class="n">bf</span> <span class="o">=</span> <span class="n">BlackFox</span><span class="p">(</span><span class="n">blackfox_url</span><span class="p">)</span>

<span class="n">ec</span> <span class="o">=</span> <span class="n">OptimizationEngineConfig</span><span class="p">(</span><span class="n">proc_timeout_miliseconds</span><span class="o">=</span><span class="mi">2000000</span><span class="p">,</span> <span class="n">population_size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">max_num_of_generations</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">KerasOptimizationConfig</span><span class="p">(</span><span class="n">engine_config</span><span class="o">=</span><span class="n">ec</span><span class="p">,</span> <span class="n">max_epoch</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">,</span> <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">time</span>
<span class="n">start3</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># Use CTRL + C to stop optimization
</span><span class="p">(</span><span class="n">ann_io</span><span class="p">,</span> <span class="n">ann_info</span><span class="p">,</span> <span class="n">ann_metadata</span><span class="p">)</span> <span class="o">=</span> <span class="n">bf</span><span class="o">.</span><span class="n">optimize_keras_sync</span><span class="p">(</span>
    <span class="n">input_set</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">,</span>
    <span class="n">output_set</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">c</span><span class="p">,</span>
    <span class="n">integrate_scaler</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">network_path</span><span class="o">=</span><span class="s">'OptimizedANNCancer_final.h5'</span>
<span class="p">)</span>

<span class="n">end3</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">time3</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">end3</span><span class="o">-</span><span class="n">start3</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">ann info:'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">ann_info</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">ann metadata:'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">ann_metadata</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="data-that-we-transfer-to-black-fox-service-are-not-scaled-the-service-will-scale-the-date-by-its-own-and-when-he-finish-his-job-he-wont-change-the-data-but-service-ofers-us-command-to-scale-our-data-for-prediction-as-he-did-and-we-will-ofcourse-use-that">Data that we transfer to Black Fox service are not scaled, the service will scale the date by its own and when he finish his job he won’t change the data, but service ofers us command to scale our data for prediction as he did and we will ofcourse use that.</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Get metadata
</span><span class="n">meta</span> <span class="o">=</span> <span class="n">bf</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">(</span><span class="s">'OptimizedANNCancer_final.h5'</span><span class="p">)</span>
<span class="n">scaler_config</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[</span><span class="s">'scaler_config'</span><span class="p">]</span>

<span class="c1"># Scale
</span><span class="n">x_scaler_config</span> <span class="o">=</span> <span class="n">scaler_config</span><span class="p">[</span><span class="s">'input'</span><span class="p">]</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span> 
<span class="n">min_max_x</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">(</span><span class="n">feature_range</span><span class="o">=</span><span class="n">x_scaler_config</span><span class="p">[</span><span class="s">'feature_range'</span><span class="p">])</span>
<span class="n">min_max_x</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_scaler_config</span><span class="p">[</span><span class="s">'fit'</span><span class="p">])</span>

<span class="n">X_test_minMaxScaled_withBF</span> <span class="o">=</span> <span class="n">min_max_x</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="c1">#print(X_test_minMaxScaled_withBF[:10,:])
</span></code></pre></div></div>

<h4 id="prediction">Prediction:</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Importing ANN model
</span><span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">load_model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="s">'OptimizedANNCancer_final.h5'</span><span class="p">)</span>

<span class="n">y_pred_BF</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_minMaxScaled_withBF</span><span class="p">)</span>
<span class="c1">#print("Predicted values are:\n\n", y_pred_BF[:10,:])
</span></code></pre></div></div>

<h4 id="restoring-the-results-on-real-values">Restoring the results on real values:</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Rescale
</span><span class="n">y_scaler_config</span> <span class="o">=</span> <span class="n">scaler_config</span><span class="p">[</span><span class="s">'output'</span><span class="p">]</span>
<span class="n">min_max_y</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">(</span><span class="n">feature_range</span><span class="o">=</span><span class="n">y_scaler_config</span><span class="p">[</span><span class="s">'feature_range'</span><span class="p">])</span>
<span class="n">min_max_y</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_scaler_config</span><span class="p">[</span><span class="s">'fit'</span><span class="p">])</span>

<span class="n">y_pred_BF_realValues</span> <span class="o">=</span> <span class="n">min_max_y</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_pred_BF</span><span class="p">)</span>
<span class="c1">#print("\nFirst 6 real predicted values are:\n", y_pred_BF_realValues[:6,:])
</span>
<span class="c1">#y_pred_BF_realValues = mms_y.inverse_transform(y_pred_BF)
#print("\nFirst 6 real predicted values are:\n", y_pred_BF_realValues[:6,:])
</span></code></pre></div></div>

<h4 id="calculating-the-error">Calculating the error:</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y_winner_BF</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_pred_BF_realValues</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;</span><span class="n">y_pred_BF</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">y_winner_BF</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y_winner_BF</span> <span class="o">==</span> <span class="bp">True</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">y_winner_test</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_test</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;</span><span class="n">y_test</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">y_winner_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y_winner_test</span> <span class="o">==</span> <span class="bp">True</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_winner_BF</span><span class="p">,</span> <span class="n">y_winner_test</span><span class="p">)</span>

<span class="n">errorOnTestSetBF</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="n">cm</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">cm</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">minutes3</span><span class="p">,</span> <span class="n">seconds3</span><span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">time3</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
<span class="n">hours3</span><span class="p">,</span> <span class="n">minutes3</span><span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">minutes3</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Time for finding the best ANN by Black Fox service is "</span><span class="p">,</span> <span class="n">time3</span><span class="p">,</span><span class="s">"seconds("</span><span class="p">,</span><span class="n">hours3</span><span class="p">,</span><span class="s">"hours,"</span><span class="p">,</span><span class="n">minutes3</span><span class="p">,</span><span class="s">"minutes and "</span><span class="p">,</span><span class="n">seconds3</span><span class="p">,</span><span class="s">"seconds)."</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">We got confusion matrix:</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">cm</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Test set error for finding the best ANN by Black Fox service, which we can read in confusion matrix is"</span><span class="p">,</span><span class="n">errorOnTestSetBF</span><span class="p">,</span><span class="s">"</span><span class="si">%</span><span class="s">."</span><span class="p">)</span>
</code></pre></div></div>

<h1 id="results-and-discussion">RESULTS AND DISCUSSION</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Time to manually train one network is "</span><span class="p">,</span> <span class="n">time1</span><span class="p">,</span><span class="s">"seconds("</span><span class="p">,</span><span class="n">hours1</span><span class="p">,</span><span class="s">"hours,"</span><span class="p">,</span><span class="n">minutes1</span><span class="p">,</span><span class="s">"minutes and "</span><span class="p">,</span><span class="n">seconds1</span><span class="p">,</span><span class="s">"seconds )."</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Time needed for tuning is "</span><span class="p">,</span> <span class="n">time2</span><span class="p">,</span><span class="s">"seconds("</span><span class="p">,</span><span class="n">hours2</span><span class="p">,</span><span class="s">"hours,"</span><span class="p">,</span><span class="n">minutes2</span><span class="p">,</span><span class="s">"minutes and "</span><span class="p">,</span><span class="n">seconds2</span><span class="p">,</span><span class="s">"seconds)."</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Time for finding the best ANN by Black Fox service is "</span><span class="p">,</span> <span class="n">time3</span><span class="p">,</span><span class="s">"seconds("</span><span class="p">,</span><span class="n">hours3</span><span class="p">,</span><span class="s">"hours,"</span><span class="p">,</span><span class="n">minutes3</span><span class="p">,</span><span class="s">"minutes and "</span><span class="p">,</span><span class="n">seconds3</span><span class="p">,</span><span class="s">"seconds)."</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Let's visualize the results:</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>

<span class="n">objects</span> <span class="o">=</span> <span class="p">(</span><span class="s">'TrainingANN'</span><span class="p">,</span> <span class="s">'TuningANN'</span><span class="p">,</span> <span class="s">'BFservice'</span><span class="p">)</span>
<span class="n">y_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">objects</span><span class="p">))</span>
<span class="n">performance</span> <span class="o">=</span> <span class="p">[</span><span class="n">time1</span><span class="p">,</span><span class="n">time2</span><span class="p">,</span><span class="n">time3</span><span class="p">]</span>
 
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">y_pos</span><span class="p">,</span> <span class="n">performance</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="s">'blue'</span><span class="p">,</span><span class="s">'red'</span><span class="p">,</span><span class="s">'green'</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">y_pos</span><span class="p">,</span> <span class="n">objects</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Time (seconds)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Time spent on making ANN'</span><span class="p">)</span>
 
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<h4 id="if-we-want-to-compare-the-results-by-making-ann-manually-and-making-it-with-black-fox-service-we-would-need-to-add-the-time-spent-in-field-trainingann-and-tuningann-in-plot-above-and-that-added-time-would-be-comparatible-with-time-black-fox-service-spent-which-are-so-different-time-needed-for-manually-hard-work-is-much-larger-then-time-black-fox-spent-to-make-better-results-that-are-given-in-the-plot-below">If we want to compare the results by making ANN manually and making it with Black Fox service, we would need to add the time spent in field “TrainingANN” and “TuningANN” in plot above, and that added time would be comparatible with time Black Fox service spent, which are so different, time needed for manually hard work is much larger then time Black Fox spent to make better results, that are given in the plot below.</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Test set error on manually train one network, which we can read in confusion matrix is"</span><span class="p">,</span><span class="n">errorOnTestSetTrained</span><span class="p">,</span><span class="s">"</span><span class="si">%</span><span class="s">."</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Test set error with tuning, which we can read in confusion matrix is"</span><span class="p">,</span><span class="n">errorOnTestSetTuning</span><span class="p">,</span><span class="s">"</span><span class="si">%</span><span class="s">."</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Test set error for finding the best ANN by Black Fox service, which we can read in confusion matrix is"</span><span class="p">,</span><span class="n">errorOnTestSetBF</span><span class="p">,</span><span class="s">"</span><span class="si">%</span><span class="s">."</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Let's visualize the results:</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>

<span class="n">objects</span> <span class="o">=</span> <span class="p">(</span><span class="s">'TrainingANN'</span><span class="p">,</span> <span class="s">'TuningANN'</span><span class="p">,</span> <span class="s">'BFservice'</span><span class="p">)</span>
<span class="n">y_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">objects</span><span class="p">))</span>
<span class="n">performance</span> <span class="o">=</span> <span class="p">[</span><span class="n">errorOnTestSetTrained</span><span class="p">,</span><span class="n">errorOnTestSetTuning</span><span class="p">,</span><span class="n">errorOnTestSetBF</span><span class="p">]</span>
 
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">y_pos</span><span class="p">,</span> <span class="n">performance</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="s">'blue'</span><span class="p">,</span><span class="s">'red'</span><span class="p">,</span><span class="s">'green'</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">y_pos</span><span class="p">,</span> <span class="n">objects</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Error (</span><span class="si">%</span><span class="s">)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Test set error'</span><span class="p">)</span>
 
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<h4 id="although-we-measured-this-three-options-actually-they-are-not-so-comparable-because-in-python-we-had-a-man-sitting-in-office-and-programming-those-neural-networksoption-1-and-2-while-in-black-fox-service-option-3-he-imported-the-same-data-set-and-the-service-did-the-rest-while-he-went-to-rest-or-dring-coffe-for-example-so-actually-in-black-fox-service-he-wrote-few-lines-of-code-and-thats-all-of-hard-work-results-in-the-given-plots-above-speak-for-themself-as-you-can-see-black-fox-service-gave-better-results-in-less-time-and-effort-to-create-approximate-results-in-python-as-black-fox-did-is-immeasurably-large">Although we measured this three options, actually they are not so comparable, because in Python we had a man sitting in office and programming those neural networks(option 1 and 2) while in Black Fox service (option 3), he imported the same data set and the service did the rest, while he went to rest or dring coffe, for example, so actually, in Black Fox service he wrote few lines of code and thats all of hard work. Results in the given plots above speak for themself. As you can see, Black Fox service gave better results in less time and effort to create approximate results in Python as Black Fox did is immeasurably large.</h4>



        </div>

        
      </section>

      <footer class="page__meta">
        
        


        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/examples/building/" class="pagination--pager" title="Building Example
">Previous</a>
    
    
      <a href="/examples/churn/" class="pagination--pager" title="Churn Example
">Next</a>
    
  </nav>

    </div>

    
  </article>
  <div>
    <a href="../jupyter/Cancer_trening.ipynb" download>Jupyter notebook</a><br/>
    <a href="../jupyter/Cancer_trening.md" download>Markdown</a>
  </div>

  
  
</div>
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><input type="text" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
    <div id="results" class="results"></div></div>

      </div>
    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://github.com/vodena" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2019 Vodéna. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script data-search-pseudo-elements defer src="https://use.fontawesome.com/releases/v5.7.1/js/all.js" integrity="sha384-eVEQC9zshBn0rFj4+TU78eNA19HMNigMviK/PU/FFjLXqa/GKPgX58rvt5Z8PLs7" crossorigin="anonymous"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>





  </body>
</html>
