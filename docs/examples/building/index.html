<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.16.0 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Building Example - BlackFox examples</title>
<meta name="description" content="">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="BlackFox examples">
<meta property="og:title" content="Building Example">
<meta property="og:url" content="/blackfox-examples/examples/building/">


  <meta property="og:description" content="">







  <meta property="article:published_time" content="2019-04-22T09:24:49+02:00">






<link rel="canonical" href="/blackfox-examples/examples/building/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "Vodéna",
      "url": null,
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/blackfox-examples/feed.xml" type="application/atom+xml" rel="alternate" title="BlackFox examples Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/blackfox-examples/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--example wide">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/blackfox-examples/"><img src="/blackfox-examples/assets/images/apple-touch-icon.png" alt=""></a>
        
        <a class="site-title" href="/blackfox-examples/">BlackFox Examples</a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/blackfox-examples/posts/" >Posts</a>
            </li><li class="masthead__menu-item">
              <a href="/blackfox-examples/examples/" >Examples</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  

  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    
    <!-- <meta itemprop="headline" content="Building Example"> -->
    
    
    <!-- <meta itemprop="description" content=""> -->
    
    
    

    <div class="page__inner-wrap">
      
      <!-- <header>
        <h1 id="page-title" class="page__title" itemprop="headline">
          Building Example
</h1>
        
      </header> -->
      

      <section class="page__content" itemprop="text">
        

        


        <div>

          
<h1 id="building">Building</h1>

<h3 id="problem-explanation">Problem explanation:</h3>

<p>Prediction of energy consumption in a building. Try to predict the hourly consumption of electrical energy, hot water, and cold water, based on the date, time of day, outside temperature, outside air humidity, solar radiation, and wind speed.
The data set was created based on problem A of “The Great Energy Predictor Shootout - the first building data analysis and prediction problem” contest, organized in 1993 for the ASHRAE мeeting in Denver, Colorado. The data set itself is located here, in the field building.</p>

<p>This is regression problem and the results  are three outputs, hourly consumption of electrical energy, hot water, and cold water. Model inputs are:</p>

<ul>
  <li>Day,</li>
  <li>Hour,</li>
  <li>Temperature,</li>
  <li>Humidity,</li>
  <li>Solar radiation,</li>
  <li>Wind speed.</li>
</ul>

<h3 id="problem-solution">Problem solution:</h3>
<p>Data set contains 4208 observations,we have divided the data set in two sets, training set, which contains 3366 observations and test set, which contains 842 observations. We solved problem in three ways:</p>

<ul>
  <li>Manually buiilding ANN,</li>
  <li>Tune some hyperparameters by using grid search and</li>
  <li>Employing Black Fox service.</li>
</ul>

<p>We evaluate the performance of the models using K-fold cross validation. For the purpose of feature scaling, we apply a min max scaler. To stop the training at the right time, Keras’ early stopping scheme is applied.</p>

<h3 id="update-keras-to-latest-version">Update Keras to latest version</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">keras</span><span class="o">==</span><span class="mf">2.2.4</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Requirement already satisfied: keras==2.2.4 in /home/nbuser/anaconda3_501/lib/python3.6/site-packages (2.2.4)
Requirement already satisfied: keras-applications&gt;=1.0.6 in /home/nbuser/anaconda3_501/lib/python3.6/site-packages (from keras==2.2.4) (1.0.7)
Requirement already satisfied: pyyaml in /home/nbuser/anaconda3_501/lib/python3.6/site-packages (from keras==2.2.4) (3.13)
Requirement already satisfied: h5py in /home/nbuser/anaconda3_501/lib/python3.6/site-packages (from keras==2.2.4) (2.8.0)
Requirement already satisfied: six&gt;=1.9.0 in /home/nbuser/anaconda3_501/lib/python3.6/site-packages (from keras==2.2.4) (1.11.0)
Requirement already satisfied: numpy&gt;=1.9.1 in /home/nbuser/anaconda3_501/lib/python3.6/site-packages (from keras==2.2.4) (1.14.6)
Requirement already satisfied: scipy&gt;=0.14 in /home/nbuser/anaconda3_501/lib/python3.6/site-packages (from keras==2.2.4) (1.1.0)
Requirement already satisfied: keras-preprocessing&gt;=1.0.5 in /home/nbuser/anaconda3_501/lib/python3.6/site-packages (from keras==2.2.4) (1.0.9)
</code></pre></div></div>

<h1 id="data-preprocessing">Data preprocessing</h1>
<h4 id="importing-data-frame">Importing data frame</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Importing the libraries
</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="n">mpl</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s">'ggplot'</span><span class="p">)</span>

<span class="n">dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'BuildingData.csv'</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="dataset-info">Dataset info</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dataframe</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 4208 entries, 0 to 4207
Data columns (total 17 columns):
Monday       4208 non-null int64
Tuesday      4208 non-null int64
Wednesday    4208 non-null int64
Thursday     4208 non-null int64
Friday       4208 non-null int64
Saturday     4208 non-null int64
Sunday       4208 non-null int64
Nhour1       4208 non-null float64
Nhour2       4208 non-null float64
Nhour3       4208 non-null int64
Temp         4208 non-null float64
Humid        4208 non-null float64
Solar        4208 non-null float64
Wind         4208 non-null float64
Wbe          4208 non-null float64
Wbcw         4208 non-null float64
Wbhw         4208 non-null float64
dtypes: float64(9), int64(8)
memory usage: 559.0 KB
</code></pre></div></div>

<h4 id="dataset-description">Dataset description</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dataframe</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Monday</th>
      <th>Tuesday</th>
      <th>Wednesday</th>
      <th>Thursday</th>
      <th>Friday</th>
      <th>Saturday</th>
      <th>Sunday</th>
      <th>Nhour1</th>
      <th>Nhour2</th>
      <th>Nhour3</th>
      <th>Temp</th>
      <th>Humid</th>
      <th>Solar</th>
      <th>Wind</th>
      <th>Wbe</th>
      <th>Wbcw</th>
      <th>Wbhw</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>4208.000000</td>
      <td>4208.000000</td>
      <td>4208.000000</td>
      <td>4208.000000</td>
      <td>4208.000000</td>
      <td>4208.000000</td>
      <td>4208.000000</td>
      <td>4208.000000</td>
      <td>4208.000000</td>
      <td>4208.000000</td>
      <td>4208.000000</td>
      <td>4208.000000</td>
      <td>4208.000000</td>
      <td>4208.000000</td>
      <td>4208.000000</td>
      <td>4208.000000</td>
      <td>4208.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.144487</td>
      <td>0.142586</td>
      <td>0.142586</td>
      <td>0.142586</td>
      <td>0.142586</td>
      <td>0.142586</td>
      <td>0.142586</td>
      <td>0.500079</td>
      <td>-0.000992</td>
      <td>0.001901</td>
      <td>0.609596</td>
      <td>0.282694</td>
      <td>0.149780</td>
      <td>0.236274</td>
      <td>0.450551</td>
      <td>0.451385</td>
      <td>0.339658</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.351624</td>
      <td>0.349691</td>
      <td>0.349691</td>
      <td>0.349691</td>
      <td>0.349691</td>
      <td>0.349691</td>
      <td>0.349691</td>
      <td>0.290556</td>
      <td>0.601920</td>
      <td>1.000117</td>
      <td>0.162364</td>
      <td>0.199956</td>
      <td>0.225103</td>
      <td>0.125516</td>
      <td>0.104934</td>
      <td>0.085478</td>
      <td>0.144851</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-1.000000</td>
      <td>-1.000000</td>
      <td>0.026000</td>
      <td>0.000000</td>
      <td>0.008774</td>
      <td>0.000000</td>
      <td>0.259145</td>
      <td>0.075000</td>
      <td>0.081818</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.250000</td>
      <td>-0.565217</td>
      <td>-1.000000</td>
      <td>0.494000</td>
      <td>0.127860</td>
      <td>0.010377</td>
      <td>0.148214</td>
      <td>0.374563</td>
      <td>0.397500</td>
      <td>0.204545</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.500000</td>
      <td>-0.043478</td>
      <td>1.000000</td>
      <td>0.620000</td>
      <td>0.225680</td>
      <td>0.012358</td>
      <td>0.221965</td>
      <td>0.415665</td>
      <td>0.450000</td>
      <td>0.337500</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.750000</td>
      <td>0.478261</td>
      <td>1.000000</td>
      <td>0.727000</td>
      <td>0.413330</td>
      <td>0.207146</td>
      <td>0.309286</td>
      <td>0.522325</td>
      <td>0.510000</td>
      <td>0.460227</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.995000</td>
      <td>0.888000</td>
      <td>0.976415</td>
      <td>0.938571</td>
      <td>0.689082</td>
      <td>0.675000</td>
      <td>0.726136</td>
    </tr>
  </tbody>
</table>
</div>

<h4 id="histograms-of-the-numerical-features">Histograms of the numerical features</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dataframe</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">14</span><span class="p">));</span>
</code></pre></div></div>

<p><img src="Building_training_files/Building_training_10_0.png" alt="png" /></p>

<h4 id="corelation-heatmap">Corelation heatmap</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">dataframe</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
</code></pre></div></div>

<p><img src="Building_training_files/Building_training_12_0.png" alt="png" /></p>

<h4 id="separate-the-data-frame-into-feature-matrix-x-and-dependent-variable-y">Separate the data frame into feature matrix X and dependent variable y</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">14</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">14</span><span class="p">:</span><span class="mi">17</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># To avoid dummy variable trap we remove column.
</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span>
</code></pre></div></div>

<h4 id="split-the-entire-data-set-into-the-training-set-and-test-set">Split the entire data set into the training set and test set</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="apply-the-feature-scaling-because-we-dont-wanna-have-any-feature-dominating-another-feature">Apply the feature scaling because we don’t wanna have any feature dominating another feature</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Min Max Scaler
</span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">X_train_minMaxScaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test_minMaxScaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div></div>

<h1 id="option-1---manually-build-ann-using-keras">Option 1 - manually build ANN using Keras</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Importing the keras libraries and packages
</span><span class="kn">import</span> <span class="nn">keras</span>
<span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span>
<span class="kn">from</span> <span class="nn">keras.callbacks</span> <span class="kn">import</span> <span class="n">Callback</span><span class="p">,</span> <span class="n">TensorBoard</span><span class="p">,</span> <span class="n">ModelCheckpoint</span>
<span class="kn">from</span> <span class="nn">keras.callbacks</span> <span class="kn">import</span> <span class="n">EarlyStopping</span>

<span class="kn">import</span> <span class="nn">time</span>
<span class="n">start1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="n">classifier</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span> <span class="n">kernel_initializer</span> <span class="o">=</span> <span class="s">'uniform'</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s">'sigmoid'</span><span class="p">,</span> <span class="n">input_dim</span> <span class="o">=</span> <span class="mi">13</span><span class="p">))</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span> <span class="n">kernel_initializer</span> <span class="o">=</span> <span class="s">'uniform'</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s">'sigmoid'</span><span class="p">))</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">kernel_initializer</span> <span class="o">=</span> <span class="s">'uniform'</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s">'sigmoid'</span><span class="p">))</span>
<span class="n">es</span> <span class="o">=</span> <span class="n">EarlyStopping</span><span class="p">(</span><span class="n">monitor</span> <span class="o">=</span> <span class="s">'val_loss'</span><span class="p">,</span>
                   <span class="n">mode</span> <span class="o">=</span> <span class="s">'auto'</span><span class="p">,</span>
                   <span class="c1">#min_delta = 0,
</span>                   <span class="n">patience</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
                   <span class="n">verbose</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                   <span class="c1">#baseline=0.4,
</span>                   <span class="n">restore_best_weights</span> <span class="o">=</span> <span class="bp">True</span>
                  <span class="p">)</span>
<span class="n">classifier</span><span class="o">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">optimizer</span> <span class="o">=</span> <span class="s">'adam'</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="s">'mean_absolute_error'</span><span class="p">,</span> <span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="s">'accuracy'</span><span class="p">])</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">X_train_minMaxScaled</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">validation_split</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span> <span class="n">epochs</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="n">callbacks</span> <span class="o">=</span> <span class="p">[</span><span class="n">es</span><span class="p">],</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">end1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="n">time1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">end1</span><span class="o">-</span><span class="n">start1</span><span class="p">)</span>
<span class="n">minutes1</span><span class="p">,</span> <span class="n">seconds1</span><span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">time1</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
<span class="n">hours1</span><span class="p">,</span> <span class="n">minutes1</span><span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">minutes1</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Using TensorFlow backend.


Train on 2356 samples, validate on 1010 samples
Epoch 1/500
2356/2356 [==============================] - 1s 265us/step - loss: 0.1016 - acc: 0.3846 - val_loss: 0.0933 - val_acc: 0.3822
Epoch 2/500
2356/2356 [==============================] - 0s 104us/step - loss: 0.0926 - acc: 0.3846 - val_loss: 0.0915 - val_acc: 0.3822
Epoch 3/500
2356/2356 [==============================] - 0s 112us/step - loss: 0.0920 - acc: 0.3846 - val_loss: 0.0913 - val_acc: 0.3822
.
.
.
Epoch 498/500
2356/2356 [==============================] - 0s 62us/step - loss: 0.0373 - acc: 0.8145 - val_loss: 0.0379 - val_acc: 0.7960
Epoch 499/500
2356/2356 [==============================] - 0s 62us/step - loss: 0.0374 - acc: 0.8154 - val_loss: 0.0377 - val_acc: 0.7921
Epoch 500/500
2356/2356 [==============================] - 0s 68us/step - loss: 0.0374 - acc: 0.8171 - val_loss: 0.0378 - val_acc: 0.7941
</code></pre></div></div>

<h4 id="plot-loss-during-training">Plot loss during training</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Loss'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">classifier</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s">'loss'</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s">'train'</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'blue'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">classifier</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s">'val_loss'</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s">'validation'</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'red'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="Building_training_files/Building_training_22_0.png" alt="png" /></p>

<h4 id="plot-accuracy-during-training">Plot accuracy during training</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Accuracy'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">classifier</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s">'acc'</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s">'train'</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'blue'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">classifier</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s">'val_acc'</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s">'validation'</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'red'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="Building_training_files/Building_training_24_0.png" alt="png" /></p>

<h4 id="we-just-trained-our-artificial-neural-network-on-the-training-set-and-now-its-time-to-make-the-prediction-on-the-test-set">We just trained our artificial neural network on the training set and now it’s time to make the prediction on the test set</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y_pred_trained</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_minMaxScaled</span><span class="p">)</span>
<span class="c1">#print("Predicted values are:\n\n", y_pred_trained[:10,:])
</span>
<span class="n">t1</span><span class="o">=</span><span class="n">y_pred_trained</span> <span class="o">-</span> <span class="n">y_test</span>
<span class="n">t2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span>

<span class="n">t21</span><span class="o">=</span><span class="n">t2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="n">t22</span><span class="o">=</span><span class="n">t2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="n">t23</span><span class="o">=</span><span class="n">t2</span><span class="p">[:,</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>

<span class="n">t31</span><span class="o">=</span><span class="n">t21</span><span class="o">.</span><span class="nb">sum</span><span class="p">()</span>
<span class="n">t32</span><span class="o">=</span><span class="n">t22</span><span class="o">.</span><span class="nb">sum</span><span class="p">()</span>
<span class="n">t33</span><span class="o">=</span><span class="n">t23</span><span class="o">.</span><span class="nb">sum</span><span class="p">()</span>

<span class="n">t41</span><span class="o">=</span><span class="n">t31</span><span class="o">/</span><span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">t42</span><span class="o">=</span><span class="n">t32</span><span class="o">/</span><span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">t43</span><span class="o">=</span><span class="n">t33</span><span class="o">/</span><span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">Rmse1_trained</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">t41</span><span class="p">)</span>
<span class="n">Rmse2_trained</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">t42</span><span class="p">)</span>
<span class="n">Rmse3_trained</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">t43</span><span class="p">)</span>

<span class="n">t_max1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nb">max</span><span class="p">(</span><span class="n">y_test</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">])</span>
<span class="n">t_min1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nb">min</span><span class="p">(</span><span class="n">y_test</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">])</span>
<span class="n">t_max2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nb">max</span><span class="p">(</span><span class="n">y_test</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span>
<span class="n">t_min2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nb">min</span><span class="p">(</span><span class="n">y_test</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span>
<span class="n">t_max3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nb">max</span><span class="p">(</span><span class="n">y_test</span><span class="p">[:,</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
<span class="n">t_min3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nb">min</span><span class="p">(</span><span class="n">y_test</span><span class="p">[:,</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>

<span class="n">Prmse1_trained</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="n">Rmse1_trained</span> <span class="o">/</span> <span class="p">(</span><span class="n">t_max1</span> <span class="o">-</span> <span class="n">t_min1</span><span class="p">))</span>
<span class="n">Prmse2_trained</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="n">Rmse2_trained</span> <span class="o">/</span> <span class="p">(</span><span class="n">t_max2</span> <span class="o">-</span> <span class="n">t_min2</span><span class="p">))</span>
<span class="n">Prmse3_trained</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="n">Rmse3_trained</span> <span class="o">/</span> <span class="p">(</span><span class="n">t_max3</span> <span class="o">-</span> <span class="n">t_min3</span><span class="p">))</span>

<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Time to manually train one network is "</span><span class="p">,</span> <span class="n">time1</span><span class="p">,</span><span class="s">"seconds("</span><span class="p">,</span><span class="n">hours1</span><span class="p">,</span><span class="s">"hours,"</span><span class="p">,</span><span class="n">minutes1</span><span class="p">,</span><span class="s">"minutes and "</span><span class="p">,</span><span class="n">seconds1</span><span class="p">,</span><span class="s">"seconds )."</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Rmse(WBE) = "</span><span class="p">,</span><span class="n">Rmse1_trained</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Rmse(WBCW) = "</span><span class="p">,</span><span class="n">Rmse2_trained</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Rmse(WBHW) = "</span><span class="p">,</span><span class="n">Rmse3_trained</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Prmse(WBE) = "</span><span class="p">,</span><span class="n">Prmse1_trained</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Prmse(WBCW) = "</span><span class="p">,</span><span class="n">Prmse2_trained</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Prmse(WBHW) = "</span><span class="p">,</span><span class="n">Prmse3_trained</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Time to manually train one network is  76 seconds( 0 hours, 1 minutes and  16 seconds ).

Rmse(WBE) =  0.05404059685242297
Rmse(WBCW) =  0.038942159539989675
Rmse(WBHW) =  0.061347121854048364

Prmse(WBE) =  13.013677419549916
Prmse(WBCW) =  6.572516378057329
Prmse(WBHW) =  10.166747764834389
</code></pre></div></div>

<h4 id="visualisation">Visualisation:</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_test</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">y_pred_trained</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'orange'</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s">'s'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">'Wbe'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_test</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">y_pred_trained</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'red'</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s">'o'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">'Wbcw'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_test</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="n">y_pred_trained</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'green'</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s">'d'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">'Wbhw'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Prediction'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'test values'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'predicted values'</span><span class="p">)</span>
<span class="n">_</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="nb">min</span><span class="p">(</span><span class="n">y_test</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="nb">min</span><span class="p">(</span><span class="n">y_pred_trained</span><span class="p">)),</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="nb">max</span><span class="p">(</span><span class="n">y_test</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="nb">max</span><span class="p">(</span><span class="n">y_pred_trained</span><span class="p">))],[</span><span class="nb">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="nb">min</span><span class="p">(</span><span class="n">y_test</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="nb">min</span><span class="p">(</span><span class="n">y_pred_trained</span><span class="p">)),</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="nb">max</span><span class="p">(</span><span class="n">y_test</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="nb">max</span><span class="p">(</span><span class="n">y_pred_trained</span><span class="p">))],</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'blue'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">'Our model'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s">'upper left'</span><span class="p">);</span>
</code></pre></div></div>

<p><img src="Building_training_files/Building_training_28_0.png" alt="png" /></p>

<h1 id="option-2---parameter-tuning-by-grid-search">Option 2 - Parameter tuning by Grid search</h1>
<p>We have two type of model parameters, <strong>the weights</strong> obtained during training process, and parameters that stay fixed, called the <strong>hyperparameters</strong>. The examples of th hyperparameters are <strong>number of epochs</strong>, <strong>batch size</strong>, <strong>type of optimizer</strong>, <strong>number of layers</strong>, <strong>the number of neurons layers</strong> etc. The ANN trained in <strong>Option 1</strong> used fixed values of these hyperparameters, but perhaps some other values would lead us to a better accuracy.</p>

<p>The parameter tuning is all about finding the best values of the hyperparameters. We will try this using a simple technique called <strong>Grid search</strong> that will test several combinations of hyperparameter and return the best choice that leads to the best accuracy obtained by K-fold cross validation.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">keras.wrappers.scikit_learn</span> <span class="kn">import</span> <span class="n">KerasClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span>

<span class="kn">import</span> <span class="nn">time</span>
<span class="n">start2</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">build_classifier</span><span class="p">(</span><span class="n">optimizer</span><span class="p">):</span>
   <span class="n">classifier</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
   <span class="n">classifier</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span> <span class="n">kernel_initializer</span> <span class="o">=</span> <span class="s">'uniform'</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s">'sigmoid'</span><span class="p">,</span> <span class="n">input_dim</span> <span class="o">=</span> <span class="mi">13</span><span class="p">))</span>
   <span class="n">classifier</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span> <span class="n">kernel_initializer</span> <span class="o">=</span> <span class="s">'uniform'</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s">'sigmoid'</span><span class="p">))</span>
   <span class="n">classifier</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">kernel_initializer</span> <span class="o">=</span> <span class="s">'uniform'</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s">'sigmoid'</span><span class="p">))</span>
   <span class="n">classifier</span><span class="o">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="s">'mean_absolute_error'</span><span class="p">,</span> <span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="s">'accuracy'</span><span class="p">])</span>
   <span class="k">return</span> <span class="n">classifier</span>

<span class="n">Tuning_classifier</span> <span class="o">=</span> <span class="n">KerasClassifier</span><span class="p">(</span><span class="n">build_fn</span> <span class="o">=</span> <span class="n">build_classifier</span><span class="p">)</span>
<span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s">'batch_size'</span><span class="p">:</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">32</span><span class="p">],</span>
              <span class="s">'epochs'</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
              <span class="s">'optimizer'</span><span class="p">:</span> <span class="p">[</span><span class="s">'adam'</span><span class="p">,</span> <span class="s">'rmsprop'</span><span class="p">]</span>
             <span class="p">}</span>

<span class="n">grid_search</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span> <span class="o">=</span> <span class="n">Tuning_classifier</span><span class="p">,</span>
                           <span class="n">param_grid</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">,</span>
                           <span class="c1">#scoring = 'accuracy',
</span>                           <span class="n">cv</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
                          <span class="p">)</span>

<span class="n">grid_search</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_minMaxScaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">best_parameters</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_params_</span>
<span class="n">best_accuracy</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_score_</span>

<span class="k">print</span><span class="p">(</span><span class="s">"Best parameters are :</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">best_parameters</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Best accuracy is :</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">best_accuracy</span><span class="p">)</span>


<span class="n">end2</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="n">time2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">end2</span><span class="o">-</span><span class="n">start2</span><span class="p">)</span>
<span class="n">minutes2</span><span class="p">,</span> <span class="n">seconds2</span><span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">time2</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
<span class="n">hours2</span><span class="p">,</span> <span class="n">minutes2</span><span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">minutes2</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Time training one network is "</span><span class="p">,</span> <span class="n">time2</span><span class="p">,</span><span class="s">"seconds("</span><span class="p">,</span><span class="n">hours2</span><span class="p">,</span><span class="s">"hours,"</span><span class="p">,</span><span class="n">minutes2</span><span class="p">,</span><span class="s">"minutes and "</span><span class="p">,</span><span class="n">seconds2</span><span class="p">,</span><span class="s">"seconds)."</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Epoch 1/100
3029/3029 [==============================] - 0s 137us/step - loss: 0.0982 - acc: 0.3688
Epoch 2/100
3029/3029 [==============================] - 0s 59us/step - loss: 0.0919 - acc: 0.3840
Epoch 3/100
3029/3029 [==============================] - 0s 55us/step - loss: 0.0917 - acc: 0.3840
.
.
.
Epoch 498/500
3366/3366 [==============================] - 0s 114us/step - loss: 0.0372 - acc: 0.8149
Epoch 499/500
3366/3366 [==============================] - 0s 96us/step - loss: 0.0372 - acc: 0.8143
Epoch 500/500
3366/3366 [==============================] - 0s 98us/step - loss: 0.0372 - acc: 0.8167
Best parameters are :
 {'batch_size': 32, 'epochs': 500, 'optimizer': 'adam'}

Best accuracy is :
 0.32055852653163214

Time training one network is  7144 seconds( 1 hours, 59 minutes and  4 seconds).
</code></pre></div></div>

<h4 id="our-optimized-ann-resides-in-grid_search-now-its-time-to-make-the-prediction-on-the-test-set">Our optimized ANN resides in grid_search. Now it’s time to make the prediction on the test set</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y_pred_tuning</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test_minMaxScaled</span><span class="p">)</span>
<span class="c1">#print("Predicted values are:\n\n", y_pred_tuning[:10,:])
</span>
<span class="n">t1</span><span class="o">=</span><span class="n">y_pred_tuning</span> <span class="o">-</span> <span class="n">y_test</span>
<span class="n">t2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span>

<span class="n">t21</span><span class="o">=</span><span class="n">t2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="n">t22</span><span class="o">=</span><span class="n">t2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="n">t23</span><span class="o">=</span><span class="n">t2</span><span class="p">[:,</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>

<span class="n">t31</span><span class="o">=</span><span class="n">t21</span><span class="o">.</span><span class="nb">sum</span><span class="p">()</span>
<span class="n">t32</span><span class="o">=</span><span class="n">t22</span><span class="o">.</span><span class="nb">sum</span><span class="p">()</span>
<span class="n">t33</span><span class="o">=</span><span class="n">t23</span><span class="o">.</span><span class="nb">sum</span><span class="p">()</span>

<span class="n">t41</span><span class="o">=</span><span class="n">t31</span><span class="o">/</span><span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">t42</span><span class="o">=</span><span class="n">t32</span><span class="o">/</span><span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">t43</span><span class="o">=</span><span class="n">t33</span><span class="o">/</span><span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">Rmse1_tuning</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">t41</span><span class="p">)</span>
<span class="n">Rmse2_tuning</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">t42</span><span class="p">)</span>
<span class="n">Rmse3_tuning</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">t43</span><span class="p">)</span>

<span class="n">t_max1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nb">max</span><span class="p">(</span><span class="n">y_test</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">])</span>
<span class="n">t_min1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nb">min</span><span class="p">(</span><span class="n">y_test</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">])</span>
<span class="n">t_max2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nb">max</span><span class="p">(</span><span class="n">y_test</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span>
<span class="n">t_min2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nb">min</span><span class="p">(</span><span class="n">y_test</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span>
<span class="n">t_max3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nb">max</span><span class="p">(</span><span class="n">y_test</span><span class="p">[:,</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
<span class="n">t_min3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nb">min</span><span class="p">(</span><span class="n">y_test</span><span class="p">[:,</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>

<span class="n">Prmse1_tuning</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="n">Rmse1_tuning</span> <span class="o">/</span> <span class="p">(</span><span class="n">t_max1</span> <span class="o">-</span> <span class="n">t_min1</span><span class="p">))</span>
<span class="n">Prmse2_tuning</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="n">Rmse2_tuning</span> <span class="o">/</span> <span class="p">(</span><span class="n">t_max2</span> <span class="o">-</span> <span class="n">t_min2</span><span class="p">))</span>
<span class="n">Prmse3_tuning</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="n">Rmse3_tuning</span> <span class="o">/</span> <span class="p">(</span><span class="n">t_max3</span> <span class="o">-</span> <span class="n">t_min3</span><span class="p">))</span>

<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Time needed for tuning is "</span><span class="p">,</span> <span class="n">time2</span><span class="p">,</span><span class="s">"seconds("</span><span class="p">,</span><span class="n">hours2</span><span class="p">,</span><span class="s">"hours,"</span><span class="p">,</span><span class="n">minutes2</span><span class="p">,</span><span class="s">"minutes and "</span><span class="p">,</span><span class="n">seconds2</span><span class="p">,</span><span class="s">"seconds)."</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Rmse(WBE) = "</span><span class="p">,</span><span class="n">Rmse1_tuning</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Rmse(WBCW) = "</span><span class="p">,</span><span class="n">Rmse2_tuning</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Rmse(WBHW) = "</span><span class="p">,</span><span class="n">Rmse3_tuning</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Prmse(WBE) = "</span><span class="p">,</span><span class="n">Prmse1_tuning</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Prmse(WBCW) = "</span><span class="p">,</span><span class="n">Prmse2_tuning</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Prmse(WBHW) = "</span><span class="p">,</span><span class="n">Prmse3_tuning</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Time needed for tuning is  7144 seconds( 1 hours, 59 minutes and  4 seconds).

Rmse(WBE) =  0.05420678561614596
Rmse(WBCW) =  0.0402420110770949
Rmse(WBHW) =  0.06042263827405371

Prmse(WBE) =  13.053697831755038
Prmse(WBCW) =  6.791900603729097
Prmse(WBHW) =  10.013537783885356
</code></pre></div></div>

<h4 id="visualisation-1">Visualisation:</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_test</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">y_pred_tuning</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'orange'</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s">'s'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">'Wbe'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_test</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">y_pred_tuning</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'red'</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s">'o'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">'Wbcw'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_test</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="n">y_pred_tuning</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'green'</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s">'d'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">'Wbhw'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Prediction'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'test values'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'predicted values'</span><span class="p">)</span>
<span class="n">_</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="nb">min</span><span class="p">(</span><span class="n">y_test</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="nb">min</span><span class="p">(</span><span class="n">y_pred_tuning</span><span class="p">)),</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="nb">max</span><span class="p">(</span><span class="n">y_test</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="nb">max</span><span class="p">(</span><span class="n">y_pred_tuning</span><span class="p">))],[</span><span class="nb">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="nb">min</span><span class="p">(</span><span class="n">y_test</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="nb">min</span><span class="p">(</span><span class="n">y_pred_tuning</span><span class="p">)),</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="nb">max</span><span class="p">(</span><span class="n">y_test</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="nb">max</span><span class="p">(</span><span class="n">y_pred_tuning</span><span class="p">))],</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'blue'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">'Our model'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s">'upper left'</span><span class="p">);</span>
</code></pre></div></div>

<p><img src="Building_training_files/Building_training_34_0.png" alt="png" /></p>

<h1 id="option-3---optimize-ann-using-black-fox-service">Option 3 - Optimize ANN using Black Fox service</h1>

<h4 id="install-black-fox-service">Install Black fox service</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pip</span> <span class="n">install</span> <span class="n">blackfox</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Collecting git+https://github.com/tmrdja/BlackFoxPython.git
  Cloning https://github.com/tmrdja/BlackFoxPython.git to /tmp/pip-req-build-uwtn3brn
Requirement already satisfied: urllib3&gt;=1.15 in /home/nbuser/anaconda3_501/lib/python3.6/site-packages (from blackfox==0.0.2) (1.23)
Requirement already satisfied: six&gt;=1.10 in /home/nbuser/anaconda3_501/lib/python3.6/site-packages (from blackfox==0.0.2) (1.11.0)
Requirement already satisfied: certifi in /home/nbuser/anaconda3_501/lib/python3.6/site-packages (from blackfox==0.0.2) (2018.10.15)
Requirement already satisfied: python-dateutil in /home/nbuser/anaconda3_501/lib/python3.6/site-packages (from blackfox==0.0.2) (2.7.5)
Building wheels for collected packages: blackfox
  Building wheel for blackfox (setup.py) ... [?25ldone
[?25h  Stored in directory: /tmp/pip-ephem-wheel-cache-_3g6i2oz/wheels/46/d5/ca/47789f92af70d12cb6fc5f0c752e911491b82477816f26da21
Successfully built blackfox
Installing collected packages: blackfox
Successfully installed blackfox-0.0.2
</code></pre></div></div>

<h4 id="lets-run-the-black-fox-service-to-find-best-ann-for-the-specific-problem-note-that-we-optimize-the-architecture-as-well">Let’s run the Black Fox service to find best ANN for the specific problem. Note that we optimize the architecture, as well!</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Importing the BF service libraries
</span><span class="kn">from</span> <span class="nn">blackfox</span> <span class="kn">import</span> <span class="n">BlackFox</span>
<span class="kn">from</span> <span class="nn">blackfox</span> <span class="kn">import</span> <span class="n">KerasOptimizationConfig</span>
<span class="kn">from</span> <span class="nn">blackfox</span> <span class="kn">import</span> <span class="n">OptimizationEngineConfig</span>

<span class="n">blackfox_url</span> <span class="o">=</span> <span class="s">'http://*******************'</span>
<span class="n">bf</span> <span class="o">=</span> <span class="n">BlackFox</span><span class="p">(</span><span class="n">blackfox_url</span><span class="p">)</span>

<span class="n">ec</span> <span class="o">=</span> <span class="n">OptimizationEngineConfig</span><span class="p">(</span><span class="n">proc_timeout_miliseconds</span><span class="o">=</span><span class="mi">2000000</span><span class="p">,</span> <span class="n">population_size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">max_num_of_generations</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">KerasOptimizationConfig</span><span class="p">(</span><span class="n">engine_config</span><span class="o">=</span><span class="n">ec</span><span class="p">,</span> <span class="n">max_epoch</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">time</span>
<span class="n">start3</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># Use CTRL + C to stop optimization
</span><span class="p">(</span><span class="n">ann_io</span><span class="p">,</span> <span class="n">ann_info</span><span class="p">,</span> <span class="n">ann_metadata</span><span class="p">)</span> <span class="o">=</span> <span class="n">bf</span><span class="o">.</span><span class="n">optimize_keras_sync</span><span class="p">(</span>
    <span class="n">input_set</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">,</span>
    <span class="n">output_set</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">c</span><span class="p">,</span>
    <span class="n">integrate_scaler</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">network_path</span><span class="o">=</span><span class="s">'OptimizedANNBuilding.h5'</span>
<span class="p">)</span>

<span class="n">end3</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">time3</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">end3</span><span class="o">-</span><span class="n">start3</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">ann info:'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">ann_info</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">ann metadata:'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">ann_metadata</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Use CTRL + C to stop optimization
Uploading data set
Starting...
2019-04-17 09:01:55.271232 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:02:00.519175 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:02:05.754824 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:02:11.005862 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:02:16.263560 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:02:21.507244 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:02:26.746584 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:02:31.986584 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:02:37.233483 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:02:42.474476 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:02:47.714936 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:02:52.958633 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:02:58.238349 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:03:03.507398 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:03:08.758410 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:03:13.999133 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:03:19.246796 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:03:24.487906 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:03:29.743303 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:03:35.006739 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:03:40.246473 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:03:45.486727 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:03:50.740004 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:03:55.986009 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:04:01.214653 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:04:06.455585 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:04:11.690871 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:04:16.938427 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:04:22.186266 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:04:27.431657 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:04:32.681954 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:04:37.919911 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:04:43.159529 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:04:48.402628 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:04:53.650988 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:04:58.896166 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:05:04.127794 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:05:09.366193 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:05:14.603044 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:05:19.846316 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:05:25.090811 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:05:30.339655 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:05:35.586546 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:05:40.828369 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:05:46.105325 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:05:51.346186 -&gt; Active, Generation: 0/10, Validation set error: 0.000000, Training set error: 0.000000, Epoch: 0, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:06:49.126646 -&gt; Active, Generation: 1/10, Validation set error: 0.066994, Training set error: 0.076806, Epoch: 496, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
.
.
.
2019-04-17 09:28:48.751649 -&gt; Active, Generation: 9/10, Validation set error: 0.062930, Training set error: 0.062292, Epoch: 494, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
2019-04-17 09:28:54.200651 -&gt; Finished, Generation: 10/10, Validation set error: 0.062492, Training set error: 0.060776, Epoch: 488, Optimization Id: 7a8d326b-108e-434f-8e14-487d019dbd77
stopped Finished
Downloading network 5e64bea88abf9a75e8da7f5c83391bf7a31d8af8
Saving network 5e64bea88abf9a75e8da7f5c83391bf7a31d8af8 to OptimizedANNBuilding.h5

ann info:
{'dropout': 0.0,
 'hidden_layers': [{'activation_function': 'ReLu', 'neuron_count': 10},
                   {'activation_function': 'ReLu', 'neuron_count': 10}],
 'id': '5e64bea88abf9a75e8da7f5c83391bf7a31d8af8',
 'output_layer_activation_function': 'ReLu',
 'training_algorithm': 'Nadam'}

ann metadata:
{'__version': 1, 'is_scaler_integrated': False, 'scaler_config': {'input': {'feature_range': [0, 1], 'fit': [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0, -1.0, 0.026000000000000002, 0.0, 0.00877358, 0.0], [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.995, 0.888, 0.9764149999999999, 0.9385709999999999]], 'inverse_transform': False}, 'output': {'feature_range': [0, 1], 'fit': [[0.25914499999999996, 0.075, 0.08181820000000001], [0.689082, 0.675, 0.726136]], 'inverse_transform': True}}, 'scaler_name': 'MinMaxScaler'}
</code></pre></div></div>

<h4 id="the-data-set-passed-to-the-black-fox-service-was-not-scaled-since-black-fox-scales-inputs-automatically-in-order-to-apply-obtained-ann-in-prediction-blackfox-offers-the-utility-function-to-scale-our-test-set-the-same-way">The data set passed to the Black Fox service was not scaled since Black Fox scales inputs automatically. In order to apply obtained ANN in prediction, BlackFox offers the utility function to scale our test set the same way.</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Get metadata
</span><span class="n">meta</span> <span class="o">=</span> <span class="n">bf</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">(</span><span class="s">'OptimizedANNBuilding.h5'</span><span class="p">)</span>
<span class="n">scaler_config</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[</span><span class="s">'scaler_config'</span><span class="p">]</span>

<span class="c1"># Scale
</span><span class="n">x_scaler_config</span> <span class="o">=</span> <span class="n">scaler_config</span><span class="p">[</span><span class="s">'input'</span><span class="p">]</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span> 
<span class="n">min_max_x</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">(</span><span class="n">feature_range</span><span class="o">=</span><span class="n">x_scaler_config</span><span class="p">[</span><span class="s">'feature_range'</span><span class="p">])</span>
<span class="n">min_max_x</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_scaler_config</span><span class="p">[</span><span class="s">'fit'</span><span class="p">])</span>

<span class="n">X_test_minMaxScaled_withBF</span> <span class="o">=</span> <span class="n">min_max_x</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="c1">#print(X_test_minMaxScaled_withBF[:10,:])
</span></code></pre></div></div>

<h4 id="prediction-using-ann-proposed-by-black-fox">Prediction using ANN proposed by Black Fox</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Importing ANN model
</span><span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">load_model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="s">'OptimizedANNBuilding.h5'</span><span class="p">)</span>

<span class="c1">#Prediction
</span><span class="n">y_pred_BF</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_minMaxScaled_withBF</span><span class="p">)</span>
<span class="c1">#print("Predicted values are:\n\n", y_pred_BF[:10,:])
</span></code></pre></div></div>

<h4 id="rescale">Rescale</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Rescale
</span><span class="n">y_scaler_config</span> <span class="o">=</span> <span class="n">scaler_config</span><span class="p">[</span><span class="s">'output'</span><span class="p">]</span>
<span class="n">min_max_y</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">(</span><span class="n">feature_range</span><span class="o">=</span><span class="n">y_scaler_config</span><span class="p">[</span><span class="s">'feature_range'</span><span class="p">])</span>
<span class="n">min_max_y</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_scaler_config</span><span class="p">[</span><span class="s">'fit'</span><span class="p">])</span>

<span class="n">y_pred_BF_realValues</span> <span class="o">=</span> <span class="n">min_max_y</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_pred_BF</span><span class="p">)</span>
<span class="c1">#print("\nFirst 6 real predicted values are:\n", y_pred_BF_realValues[:6,:])
</span>
<span class="c1">#y_pred_BF_realValues = mms_y.inverse_transform(y_pred_BF)
#print("\nFirst 6 real predicted values are:\n", y_pred_BF_realValues[:6,:])
</span></code></pre></div></div>

<h4 id="compute-error">Compute error</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">t1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="nb">abs</span><span class="p">(</span><span class="n">y_pred_BF_realValues</span> <span class="o">-</span> <span class="n">y_test</span><span class="p">)</span>
<span class="n">t2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span>

<span class="n">t21</span><span class="o">=</span><span class="n">t2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="n">t22</span><span class="o">=</span><span class="n">t2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="n">t23</span><span class="o">=</span><span class="n">t2</span><span class="p">[:,</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>

<span class="n">t31</span><span class="o">=</span><span class="n">t21</span><span class="o">.</span><span class="nb">sum</span><span class="p">()</span>
<span class="n">t32</span><span class="o">=</span><span class="n">t22</span><span class="o">.</span><span class="nb">sum</span><span class="p">()</span>
<span class="n">t33</span><span class="o">=</span><span class="n">t23</span><span class="o">.</span><span class="nb">sum</span><span class="p">()</span>

<span class="n">t41</span><span class="o">=</span><span class="n">t31</span><span class="o">/</span><span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">t42</span><span class="o">=</span><span class="n">t32</span><span class="o">/</span><span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">t43</span><span class="o">=</span><span class="n">t33</span><span class="o">/</span><span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">Rmse1_BF</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">t41</span><span class="p">)</span>
<span class="n">Rmse2_BF</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">t42</span><span class="p">)</span>
<span class="n">Rmse3_BF</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">t43</span><span class="p">)</span>

<span class="n">t_max1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nb">max</span><span class="p">(</span><span class="n">y_test</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">])</span>
<span class="n">t_min1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nb">min</span><span class="p">(</span><span class="n">y_test</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">])</span>
<span class="n">t_max2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nb">max</span><span class="p">(</span><span class="n">y_test</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span>
<span class="n">t_min2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nb">min</span><span class="p">(</span><span class="n">y_test</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span>
<span class="n">t_max3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nb">max</span><span class="p">(</span><span class="n">y_test</span><span class="p">[:,</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
<span class="n">t_min3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nb">min</span><span class="p">(</span><span class="n">y_test</span><span class="p">[:,</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>

<span class="n">Prmse1_BF</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="n">Rmse1_BF</span> <span class="o">/</span> <span class="p">(</span><span class="n">t_max1</span> <span class="o">-</span> <span class="n">t_min1</span><span class="p">))</span>
<span class="n">Prmse2_BF</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="n">Rmse2_BF</span> <span class="o">/</span> <span class="p">(</span><span class="n">t_max2</span> <span class="o">-</span> <span class="n">t_min2</span><span class="p">))</span>
<span class="n">Prmse3_BF</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="n">Rmse3_BF</span> <span class="o">/</span> <span class="p">(</span><span class="n">t_max3</span> <span class="o">-</span> <span class="n">t_min3</span><span class="p">))</span>

<span class="n">minutes3</span><span class="p">,</span> <span class="n">seconds3</span><span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">time3</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
<span class="n">hours3</span><span class="p">,</span> <span class="n">minutes3</span><span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">minutes3</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Time for finding the best ANN by Black Fox service is "</span><span class="p">,</span> <span class="n">time3</span><span class="p">,</span><span class="s">"seconds("</span><span class="p">,</span><span class="n">hours3</span><span class="p">,</span><span class="s">"hours,"</span><span class="p">,</span><span class="n">minutes3</span><span class="p">,</span><span class="s">"minutes and "</span><span class="p">,</span><span class="n">seconds3</span><span class="p">,</span><span class="s">"seconds)."</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Root mean square error (WBE) = "</span><span class="p">,</span> <span class="n">Rmse1_BF</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Root mean square error (WBCW) = "</span><span class="p">,</span> <span class="n">Rmse2_BF</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Root mean square error (WBHW) = "</span><span class="p">,</span> <span class="n">Rmse3_BF</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Percentage root mean square error (WBE) = "</span><span class="p">,</span> <span class="n">Prmse1_BF</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Percentage root mean square error (WBCW) = "</span><span class="p">,</span> <span class="n">Prmse2_BF</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Percentage root mean square error (WBHW) = "</span><span class="p">,</span> <span class="n">Prmse3_BF</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Time for finding the best ANN by Black Fox service is  1628 seconds( 0 hours, 27 minutes and  8 seconds).

Root mean square error (WBE) =  0.051319796759482436
Root mean square error (WBCW) =  0.036104087502828015
Root mean square error (WBHW) =  0.05719419345510545

Percentage root mean square error (WBE) =  12.35847342857064
Percentage root mean square error (WBCW) =  6.093516878114433
Percentage root mean square error (WBHW) =  9.478503977001596
</code></pre></div></div>

<h4 id="visualisation-2">Visualisation:</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_test</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">y_pred_BF_realValues</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'orange'</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s">'s'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">'Wbe'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_test</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">y_pred_BF_realValues</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'red'</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s">'o'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">'Wbcw'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_test</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="n">y_pred_BF_realValues</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'green'</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s">'d'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">'Wbhw'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Prediction'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'test values'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'predicted values'</span><span class="p">)</span>
<span class="n">_</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="nb">min</span><span class="p">(</span><span class="n">y_test</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="nb">min</span><span class="p">(</span><span class="n">y_pred_BF_realValues</span><span class="p">)),</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="nb">max</span><span class="p">(</span><span class="n">y_test</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="nb">max</span><span class="p">(</span><span class="n">y_pred_BF_realValues</span><span class="p">))],[</span><span class="nb">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="nb">min</span><span class="p">(</span><span class="n">y_test</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="nb">min</span><span class="p">(</span><span class="n">y_pred_BF_realValues</span><span class="p">)),</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="nb">max</span><span class="p">(</span><span class="n">y_test</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="nb">max</span><span class="p">(</span><span class="n">y_pred_BF_realValues</span><span class="p">))],</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'blue'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">'Our model'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s">'upper left'</span><span class="p">);</span>
</code></pre></div></div>

<p><img src="Building_training_files/Building_training_49_0.png" alt="png" /></p>

<h1 id="results-and-discussion">RESULTS AND DISCUSSION</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s">'ggplot'</span><span class="p">)</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s">'lines'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s">'font'</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s">'8'</span><span class="p">)</span>

<span class="n">n_groups</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">group_1</span> <span class="o">=</span> <span class="p">(</span><span class="n">Human_time1</span><span class="p">,</span> <span class="n">Human_time2</span><span class="p">,</span> <span class="n">Human_time3</span><span class="p">)</span>
<span class="n">group_2</span> <span class="o">=</span> <span class="p">(</span><span class="n">time1</span><span class="p">,</span> <span class="n">time2</span><span class="p">,</span> <span class="n">time3</span><span class="p">)</span>

 
<span class="c1"># Create plot
</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_groups</span><span class="p">)</span>
<span class="n">bar_width</span> <span class="o">=</span> <span class="mf">0.25</span>
<span class="n">space</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">opacity</span> <span class="o">=</span> <span class="mi">1</span>
  
<span class="n">rects1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">group_1</span><span class="p">,</span> <span class="n">bar_width</span><span class="p">,</span><span class="n">align</span> <span class="o">=</span><span class="s">'center'</span><span class="p">,</span>
<span class="n">alpha</span><span class="o">=</span><span class="n">opacity</span><span class="p">,</span>
<span class="n">label</span><span class="o">=</span><span class="s">'Human effort'</span><span class="p">)</span>

<span class="n">rects2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">group_2</span><span class="p">,</span> <span class="n">bar_width</span><span class="p">,</span><span class="n">align</span> <span class="o">=</span><span class="s">'center'</span><span class="p">,</span><span class="n">bottom</span> <span class="o">=</span><span class="n">group_1</span><span class="p">,</span>
<span class="n">alpha</span><span class="o">=</span><span class="n">opacity</span><span class="p">,</span>
<span class="n">label</span><span class="o">=</span><span class="s">'Execution time'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Comparison'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="p">(</span><span class="s">'Manual'</span><span class="p">,</span> <span class="s">'Optimized'</span><span class="p">,</span> <span class="s">'Black Fox service'</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s">'best'</span><span class="p">)</span>
 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Time ( seconds )'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="Building_training_files/Building_training_51_0.png" alt="png" /></p>

<h4 id="if-we-want-to-compare-the-results-by-creating-ann-manually-and-by-employing-the-black-fox-service-we-would-need-to-add-the-time-spent-in-field-trainingann-and-tuningann-in-plot-above-and-that-added-time-would-be-comparatible-with-time-black-fox-service-spent-which-are-so-different-time-needed-for-manually-hard-work-is-much-larger-then-time-black-fox-spent-to-make-better-results-that-are-given-in-the-plot-below">If we want to compare the results by creating ANN manually and by employing the Black Fox service, we would need to add the time spent in field “TrainingANN” and “TuningANN” in plot above, and that added time would be comparatible with time Black Fox service spent, which are so different, time needed for manually hard work is much larger then time Black Fox spent to make better results, that are given in the plot below.</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">n_groups</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">group_1</span> <span class="o">=</span> <span class="p">(</span><span class="n">Rmse1_trained</span><span class="p">,</span> <span class="n">Rmse1_tuning</span><span class="p">,</span> <span class="n">Rmse1_BF</span><span class="p">)</span>
<span class="n">group_2</span> <span class="o">=</span> <span class="p">(</span><span class="n">Rmse2_trained</span><span class="p">,</span> <span class="n">Rmse2_tuning</span><span class="p">,</span> <span class="n">Rmse2_BF</span><span class="p">)</span>
<span class="n">group_3</span> <span class="o">=</span> <span class="p">(</span><span class="n">Rmse3_trained</span><span class="p">,</span> <span class="n">Rmse3_tuning</span><span class="p">,</span> <span class="n">Rmse3_BF</span><span class="p">)</span>
 
<span class="c1"># create plot
</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_groups</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<span class="n">bar_width</span> <span class="o">=</span> <span class="mf">0.25</span>
<span class="n">opacity</span> <span class="o">=</span> <span class="mf">0.8</span>
 
<span class="n">rects1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">group_1</span><span class="p">,</span> <span class="n">bar_width</span><span class="p">,</span>
<span class="n">alpha</span><span class="o">=</span><span class="n">opacity</span><span class="p">,</span>
<span class="n">color</span><span class="o">=</span><span class="s">'b'</span><span class="p">,</span>
<span class="n">label</span><span class="o">=</span><span class="s">'WBE'</span><span class="p">)</span>
 
<span class="n">rects2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="n">bar_width</span><span class="p">,</span> <span class="n">group_2</span><span class="p">,</span> <span class="n">bar_width</span><span class="p">,</span>
<span class="n">alpha</span><span class="o">=</span><span class="n">opacity</span><span class="p">,</span>
<span class="n">color</span><span class="o">=</span><span class="s">'g'</span><span class="p">,</span>
<span class="n">label</span><span class="o">=</span><span class="s">'WBCW'</span><span class="p">)</span>

<span class="n">rects3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="n">bar_width</span> <span class="o">+</span> <span class="n">bar_width</span><span class="p">,</span> <span class="n">group_3</span><span class="p">,</span> <span class="n">bar_width</span><span class="p">,</span>
<span class="n">alpha</span><span class="o">=</span><span class="n">opacity</span><span class="p">,</span>
<span class="n">color</span><span class="o">=</span><span class="s">'r'</span><span class="p">,</span>
<span class="n">label</span><span class="o">=</span><span class="s">'WBHW'</span><span class="p">)</span>
 
<span class="c1">#plt.xlabel('Person')
</span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Error'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Root mean square error'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="n">bar_width</span><span class="p">,</span> <span class="p">(</span><span class="s">'Manual'</span><span class="p">,</span> <span class="s">'Optimized'</span><span class="p">,</span> <span class="s">'Black Fox service'</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s">'lower left'</span><span class="p">)</span>
 
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[0 1 2]
</code></pre></div></div>

<p><img src="Building_training_files/Building_training_53_1.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">n_groups</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">group_1</span> <span class="o">=</span> <span class="p">(</span><span class="n">Prmse1_trained</span><span class="p">,</span> <span class="n">Prmse1_tuning</span><span class="p">,</span> <span class="n">Prmse1_BF</span><span class="p">)</span>
<span class="n">group_2</span> <span class="o">=</span> <span class="p">(</span><span class="n">Prmse2_trained</span><span class="p">,</span> <span class="n">Prmse2_tuning</span><span class="p">,</span> <span class="n">Prmse2_BF</span><span class="p">)</span>
<span class="n">group_3</span> <span class="o">=</span> <span class="p">(</span><span class="n">Prmse3_trained</span><span class="p">,</span> <span class="n">Prmse3_tuning</span><span class="p">,</span> <span class="n">Prmse3_BF</span><span class="p">)</span>
 
<span class="c1"># create plot
</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_groups</span><span class="p">)</span>
<span class="n">bar_width</span> <span class="o">=</span> <span class="mf">0.25</span>
<span class="n">opacity</span> <span class="o">=</span> <span class="mf">0.8</span>
 
<span class="n">rects1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">group_1</span><span class="p">,</span> <span class="n">bar_width</span><span class="p">,</span>
<span class="n">alpha</span><span class="o">=</span><span class="n">opacity</span><span class="p">,</span>
<span class="n">color</span><span class="o">=</span><span class="s">'b'</span><span class="p">,</span>
<span class="n">label</span><span class="o">=</span><span class="s">'WBE'</span><span class="p">)</span>
 
<span class="n">rects2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="n">bar_width</span><span class="p">,</span> <span class="n">group_2</span><span class="p">,</span> <span class="n">bar_width</span><span class="p">,</span>
<span class="n">alpha</span><span class="o">=</span><span class="n">opacity</span><span class="p">,</span>
<span class="n">color</span><span class="o">=</span><span class="s">'g'</span><span class="p">,</span>
<span class="n">label</span><span class="o">=</span><span class="s">'WBCW'</span><span class="p">)</span>

<span class="n">rects3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="n">bar_width</span> <span class="o">+</span> <span class="n">bar_width</span><span class="p">,</span> <span class="n">group_3</span><span class="p">,</span> <span class="n">bar_width</span><span class="p">,</span>
<span class="n">alpha</span><span class="o">=</span><span class="n">opacity</span><span class="p">,</span>
<span class="n">color</span><span class="o">=</span><span class="s">'r'</span><span class="p">,</span>
<span class="n">label</span><span class="o">=</span><span class="s">'WBHW'</span><span class="p">)</span>
 
<span class="c1">#plt.xlabel('Person')
</span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Error ( </span><span class="si">% </span><span class="s">)'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Percentage root mean square error'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="n">bar_width</span><span class="p">,</span> <span class="p">(</span><span class="s">'Manual'</span><span class="p">,</span> <span class="s">'Optimized'</span><span class="p">,</span> <span class="s">'Black Fox service'</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s">'lower left'</span><span class="p">)</span>
 
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="Building_training_files/Building_training_54_0.png" alt="png" /></p>

<h4 id="although-we-measured-this-three-options-actually-they-are-not-so-comparable-because-in-python-we-had-a-man-sitting-in-office-and-programming-those-neural-networks-options-1-and-2-while-in-black-fox-service-option-3-he-imported-the-same-data-set-and-the-service-did-the-rest-while-he-went-to-rest-or-dring-coffe-for-example-so-actually-in-black-fox-service-he-wrote-few-lines-of-code-and-thats-all-of-hard-work-results-in-the-given-plots-above-speak-for-themself-as-you-can-see-black-fox-service-gave-better-results-in-less-time-and-effort-to-create-approximate-results-in-python-as-black-fox-did-is-immeasurably-large">Although we measured this three options, actually they are not so comparable, because in Python we had a man sitting in office and programming those neural networks (options 1 and 2) while in Black Fox service (option 3), he imported the same data set and the service did the rest, while he went to rest or dring coffe, for example, so actually, in Black Fox service he wrote few lines of code and thats all of hard work. Results in the given plots above speak for themself. As you can see, Black Fox service gave better results in less time and effort to create approximate results in Python as Black Fox did is immeasurably large.</h4>



        </div>

        
      </section>

      <footer class="page__meta">
        
        


        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/blackfox-examples/examples/boston/" class="pagination--pager" title="Boston Example
">Previous</a>
    
    
      <a href="/blackfox-examples/examples/cancer/" class="pagination--pager" title="Cancer Example
">Next</a>
    
  </nav>

    </div>

    
  </article>
  <div>
    <a href="../jupyter/Building_training.ipynb" download>Jupyter notebook</a><br/>
    <a href="../jupyter/Building_training.md" download>Markdown</a>
  </div>

  
  
</div>
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><input type="search" id="search" aria-placeholder="Enter your search term..." class="search-input" tabindex="-1" placeholder="Enter your search term..." />
    <div id="results" class="results"></div></div>

      </div>
    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://github.com/vodena" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
    

    <li><a href="/blackfox-examples/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2019 Vodéna. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/blackfox-examples/assets/js/main.min.js"></script>
  <script defer src="https://use.fontawesome.com/releases/v5.8.1/js/all.js" integrity="sha384-g5uSoOSBd7KkhAMlnQILrecXvzst9TdC09/VM+pjDTCM+1il8RHz5fKANTFFb+gQ" crossorigin="anonymous"></script>




<script src="/blackfox-examples/assets/js/lunr/lunr.min.js"></script>
<script src="/blackfox-examples/assets/js/lunr/lunr-store.js"></script>
<script src="/blackfox-examples/assets/js/lunr/lunr-en.js"></script>







  </body>
</html>
